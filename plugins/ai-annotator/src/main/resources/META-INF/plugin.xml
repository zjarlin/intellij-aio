<idea-plugin>
    <id>site.addzero.ai-annotator</id>

    <name>AI Annotator</name>
    <vendor email="zjarlin@outlook.com" url="https://gitee.com/zjarlin/autoddl-idea-plugin.git">zjarlin</vendor>

    <description><![CDATA[
        <h1>AI Annotator - 智能注解生成器</h1>
        <p>一个基于 AI 的 IntelliJ IDEA 插件，能够自动为 Java/Kotlin 类的字段生成注解和注释。</p>
        
        <h2>核心功能</h2>
        <ul>
            <li><strong>AI 智能推测</strong>：当字段没有注释时，使用 AI 根据字段名推测其含义</li>
            <li><strong>批量处理</strong>：一次性为类中所有字段添加注解</li>
            <li><strong>多种注解支持</strong>：
                <ul>
                    <li>Swagger 注解 (@Schema, @ApiModelProperty)</li>
                    <li>Excel 注解 (@ExcelProperty)</li>
                    <li>自定义注解（可配置模板）</li>
                </ul>
            </li>
            <li><strong>双语言支持</strong>：完整支持 Java 和 Kotlin</li>
            <li><strong>多来源注释</strong>：优先使用已有的 Javadoc、KDoc 或现有注解</li>
        </ul>
        
        <h2>使用方法</h2>
        <ol>
            <li>在 Settings → Tools → AI Annotator 中配置 AI API Key</li>
            <li>在 Java/Kotlin 类的编辑器中按 <kbd>Alt+Enter</kbd></li>
            <li>选择对应的注解添加操作：
                <ul>
                    <li>Add Swagger Annotation</li>
                    <li>Add Excel Annotation</li>
                    <li>Add Custom Annotation</li>
                </ul>
            </li>
            <li>插件会自动为所有字段添加注解，对于无注释的字段会调用 AI 生成</li>
        </ol>
        
        <h2>配置说明</h2>
        <h3>AI 配置</h3>
        <ul>
            <li><strong>AI 提供商</strong>：支持 DeepSeek、OpenAI、Ollama、DashScope</li>
            <li><strong>API Key</strong>：您的 AI 服务 API 密钥</li>
            <li><strong>模型名称</strong>：使用的具体模型（如 deepseek-chat）</li>
            <li><strong>API Base URL</strong>：API 服务地址</li>
            <li><strong>Temperature</strong>：AI 生成的随机性（0.0-1.0）</li>
        </ul>
        
        <h3>注解模板</h3>
        <ul>
            <li><strong>Swagger 注解</strong>：默认 @Schema(description = "{}")</li>
            <li><strong>Excel 注解</strong>：默认 @ExcelProperty("{}")</li>
            <li><strong>自定义注解</strong>：默认 @ApiModelProperty(value = "{}")</li>
        </ul>
        <p>模板中的 <code>{}</code> 会被替换为字段注释</p>
        
        <h3>功能选项</h3>
        <ul>
            <li><strong>启用 AI 推测</strong>：当字段无注释时是否调用 AI</li>
            <li><strong>启用批量处理</strong>：是否一次性为所有字段调用 AI</li>
        </ul>
        
        <h2>工作原理</h2>
        <p>插件会按以下优先级获取字段注释：</p>
        <ol>
            <li>Javadoc / KDoc 注释</li>
            <li>已有的 Swagger 注解</li>
            <li>已有的 Excel 注解</li>
            <li>已有的其他注解</li>
            <li>AI 推测（如果启用）</li>
        </ol>
        
        <h2>示例</h2>
        <p><strong>处理前：</strong></p>
        <pre><code>
public class User {
    private Long userId;
    private String userName;
    private Date createTime;
}
        </code></pre>
        
        <p><strong>处理后：</strong></p>
        <pre><code>
public class User {
    @Schema(description = "用户ID")
    private Long userId;
    
    @Schema(description = "用户名称")
    private String userName;
    
    @Schema(description = "创建时间")
    private Date createTime;
}
        </code></pre>
        
        <h2>支持的 AI 提供商</h2>
        <ul>
            <li><strong>DeepSeek</strong>：https://api.deepseek.com</li>
            <li><strong>OpenAI</strong>：https://api.openai.com</li>
            <li><strong>Ollama</strong>：本地部署（http://localhost:11434）</li>
            <li><strong>DashScope</strong>：阿里云通义千问</li>
        </ul>
        
        <h2>注意事项</h2>
        <ul>
            <li>使用 AI 功能需要配置有效的 API Key</li>
            <li>AI 调用可能需要几秒钟时间</li>
            <li>批量处理大量字段时请注意 API 配额限制</li>
            <li>生成的注释建议人工审核后使用</li>
        </ul>
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.java</depends>
    <depends>org.jetbrains.kotlin</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- 注册设置服务 -->
        <applicationService serviceImplementation="site.addzero.aiannotator.settings.AiAnnotatorSettingsService"/>
        
        <!-- 注册配置页面 -->
        <projectConfigurable 
            instance="site.addzero.aiannotator.settings.AiAnnotatorConfigurable" 
            displayName="AI Annotator"
            parentId="tools"/>

        <!-- 启动活动 -->
        <postStartupActivity implementation="site.addzero.aiannotator.AiAnnotatorStartupActivity"/>

        <!-- 通知组 -->
        <notificationGroup id="AI Annotator Notifications" displayType="BALLOON" isLogByDefault="true"/>
    </extensions>

    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="true"/>
    </extensions>
</idea-plugin>
