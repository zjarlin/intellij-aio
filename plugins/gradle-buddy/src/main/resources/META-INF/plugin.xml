<idea-plugin>
    <id>site.addzero.gradle-buddy</id>
    <name>Gradle Buddy</name>
    <vendor>AddZero</vendor>
    <description>
        A plugin that helps you manage Gradle projects by showing an indicator when a project is not loaded.
        When you open a file in a Gradle project that hasn't been loaded, it shows an indicator in the status bar
        to remind you to load the Gradle project.

        Features:
        - On-demand module loading
        - Auto-release unused modules
        - Migrate project() dependencies to Maven artifacts
    </description>

    <depends>com.intellij.modules.platform</depends>
    <depends>org.jetbrains.plugins.gradle</depends>

    <extensions defaultExtensionNs="com.intellij">
        <postStartupActivity implementation="site.addzero.gradle.buddy.GradleBuddyPlugin"/>
        
        <!-- Notification Group -->
        <notificationGroup id="GradleBuddy" displayType="BALLOON" isLogByDefault="true"/>
        
        <!-- Intention: Update dependency to latest version -->
        <intentionAction>
            <language>kotlin</language>
            <className>site.addzero.gradle.buddy.intentions.GradleKtsUpdateDependencyIntention</className>
            <category>Gradle Buddy</category>
        </intentionAction>
        
        <!-- Current Module Tasks Tool Window -->
        <toolWindow id="Module Tasks" 
                    anchor="right" 
                    secondary="true"
                    icon="AllIcons.Actions.Execute"
                    factoryClass="site.addzero.gradle.buddy.filter.CurrentModuleGradleTasksToolWindowFactory"/>
    </extensions>

    <actions>
        <action id="GradleBuddy.MigrateProjectDependencies"
                class="site.addzero.gradle.buddy.migration.MigrateProjectDependenciesAction"
                text="Migrate project() to Maven Dependencies"
                description="Scan project() dependencies and replace them with Maven artifacts">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
        </action>
        
        <action id="GradleBuddy.MigrateToVersionCatalog"
                class="site.addzero.gradle.buddy.catalog.MigrateToVersionCatalogAction"
                text="Migrate to Version Catalog"
                description="Migrate hardcoded dependencies to gradle/libs.versions.toml">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <add-to-group group-id="ProjectViewPopupMenu" anchor="last"/>
        </action>
        
        <!-- On-Demand Module Loading Actions -->
        <action id="GradleBuddy.LoadOnlyOpenTabModules"
                class="site.addzero.gradle.buddy.ondemand.LoadOnlyOpenTabModulesAction"
                text="Load Only Open Tab Modules"
                description="Load only Gradle modules that correspond to currently open editor tabs">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt shift L"/>
        </action>
        
        <action id="GradleBuddy.RestoreAllModules"
                class="site.addzero.gradle.buddy.ondemand.RestoreAllModulesAction"
                text="Restore All Gradle Modules"
                description="Restore all modules that were excluded by Gradle Buddy">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
        </action>

    </actions>

    <applicationListeners>
        <listener class="site.addzero.gradle.buddy.GradleBuddyProjectManagerListener"
                  topic="com.intellij.openapi.project.ProjectCloseListener"/>
    </applicationListeners>
</idea-plugin>
