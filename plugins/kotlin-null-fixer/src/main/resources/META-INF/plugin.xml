<idea-plugin>
    <id>site.addzero.kotlin-null-fixer</id>
    <name>Kotlin Null Fixer</name>
    <vendor email="zjarlin@outlook.com" url="https://gitee.com/zjarlin">zjarlin</vendor>

    <description><![CDATA[
        Batch fix Kotlin null-safety errors in one click. Automatically replaces unsafe dot calls (.)
        with safe calls (?.) on nullable receivers, and fixes return type mismatches with .orEmpty()
        or elvis operator. Shows an editor banner when fixable null-safety errors are detected.
    ]]></description>

    <idea-version since-build="242" until-build="262.*"/>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.lang</depends>
    <depends>org.jetbrains.kotlin</depends>

    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="true"/>
    </extensions>

    <extensions defaultExtensionNs="com.intellij">
        <notificationGroup id="KotlinNullFixer" displayType="BALLOON" isLogByDefault="true"/>

        <!-- 编辑器顶部横幅：有空安全错误时显示修复按钮 -->
        <editorNotificationProvider
            implementation="site.addzero.nullfixer.NullSafetyEditorNotificationProvider"/>

        <!-- 高亮完成后刷新横幅 -->
        <postStartupActivity implementation="site.addzero.nullfixer.NullSafetyDaemonListener"/>
    </extensions>

    <actions>
        <!-- 右键菜单 + Tools 菜单（不依赖横幅也能用） -->
        <action id="KotlinNullFixer.FixFile"
                class="site.addzero.nullfixer.FixNullSafetyAction"
                text="Fix Null Safety → ?."
                description="Replace all unsafe dot calls with safe calls (?.) in the current Kotlin file"
                icon="AllIcons.Actions.QuickfixBulb">
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            <add-to-group group-id="EditorPopupMenu" anchor="last"/>
        </action>
    </actions>
</idea-plugin>
